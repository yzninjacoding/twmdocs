"use strict";(self.webpackChunktwmdocs=self.webpackChunktwmdocs||[]).push([[269],{9897:(e,r,t)=>{t.d(r,{xA:()=>d,yg:()=>m});var i=t(4805);function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,i)}return t}function a(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){n(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function l(e,r){if(null==e)return{};var t,i,n=function(e,r){if(null==e)return{};var t,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)t=o[i],r.indexOf(t)>=0||(n[t]=e[t]);return n}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)t=o[i],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var s=i.createContext({}),p=function(e){var r=i.useContext(s),t=r;return e&&(t="function"==typeof e?e(r):a(a({},r),e)),t},d=function(e){var r=p(e.components);return i.createElement(s.Provider,{value:r},e.children)},c="mdxType",g={inlineCode:"code",wrapper:function(e){var r=e.children;return i.createElement(i.Fragment,{},r)}},u=i.forwardRef((function(e,r){var t=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=p(t),u=n,m=c["".concat(s,".").concat(u)]||c[u]||g[u]||o;return t?i.createElement(m,a(a({ref:r},d),{},{components:t})):i.createElement(m,a({ref:r},d))}));function m(e,r){var t=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var o=t.length,a=new Array(o);a[0]=u;var l={};for(var s in r)hasOwnProperty.call(r,s)&&(l[s]=r[s]);l.originalType=e,l[c]="string"==typeof e?e:n,a[1]=l;for(var p=2;p<o;p++)a[p]=t[p];return i.createElement.apply(null,a)}return i.createElement.apply(null,t)}u.displayName="MDXCreateElement"},1424:(e,r,t)=>{t.r(r),t.d(r,{contentTitle:()=>p,default:()=>m,frontMatter:()=>s,metadata:()=>d,toc:()=>c});var i=t(423),n=(t(4805),t(9897));const o=t.p+"assets/images/limitEntryExample-ac039f3e3eaffe4955eef11c51481bdb.png",a=t.p+"assets/images/stopMarket1-5034d4724492541f470898ea6a76bc52.png",l=t.p+"assets/images/stopMarket2-f34b8c898df4fcebd6bb73242547002c.png",s={sidebar_position:3},p="Strategies",d={unversionedId:"code/strategies",id:"code/strategies",isDocsHomePage:!1,title:"Strategies",description:"Initialization",source:"@site/docs/code/strategies.md",sourceDirName:"code",slug:"/code/strategies",permalink:"/twmdocs/docs/code/strategies",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Indicators",permalink:"/twmdocs/docs/code/indicators"},next:{title:"Miscellaneous",permalink:"/twmdocs/docs/code/misc"}},c=[{value:"Initialization",id:"initialization",children:[]},{value:"Orders",id:"orders",children:[]},{value:"Market Orders",id:"market-orders",children:[]},{value:"Limit Orders",id:"limit-orders",children:[]},{value:"Stop-Market Orders",id:"stop-market-orders",children:[]},{value:"Stop-Limit Orders",id:"stop-limit-orders",children:[]},{value:"Positions",id:"positions",children:[]}],g={toc:c},u="wrapper";function m(e){let{components:r,...t}=e;return(0,n.yg)(u,(0,i.A)({},g,t,{components:r,mdxType:"MDXLayout"}),(0,n.yg)("h1",{id:"strategies"},"Strategies"),(0,n.yg)("h3",{id:"initialization"},"Initialization"),(0,n.yg)("p",null,"Each strategy has to be created with a ",(0,n.yg)("strong",{parentName:"p"},"unique GUID"),". Inside Visual Studio you can go to ",(0,n.yg)("inlineCode",{parentName:"p"},"Tools -> Create GUID")," to generate a unique GUID for your strategy."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-js"},'private const string SystemVersion = " V1.0";\nprivate const string StrategyName = "MA Crossover";\nprivate const string StrategyGuid = "C8BFB4D3-2C74-469F-8A25-397BFE3DD574";\n\npublic override void OnStateChanged()\n{\n    if (State == State.SetDefaults)\n    {\n        Name = StrategyName + SystemVersion;\n        Guid = new Guid(StrategyGuid);\n        Version = SystemVersion;\n    }\n}\n')),(0,n.yg)("h3",{id:"orders"},"Orders"),(0,n.yg)("p",null,"To analyze potential fills during historical execution for ",(0,n.yg)("inlineCode",{parentName:"p"},"stop-market"),", ",(0,n.yg)("inlineCode",{parentName:"p"},"limit"),", and ",(0,n.yg)("inlineCode",{parentName:"p"},"stop-limit")," orders TWM uses an internal BeforeBarUpdate event. The OnBarUpdate event occurs after the BeforeBarUpdate for the same bar index."),(0,n.yg)("p",null,(0,n.yg)("inlineCode",{parentName:"p"},"OrderAction.Buy")," - will open a long position, should be used on initial position opening and scaling in"),(0,n.yg)("p",null,(0,n.yg)("inlineCode",{parentName:"p"},"OrderAction.Sell")," - will close a long position, , should be used for closing the position or scaling out"),(0,n.yg)("p",null,(0,n.yg)("inlineCode",{parentName:"p"},"OrderAction.SellShort")," - will open a short position, should be used on initial position opening and scaling in"),(0,n.yg)("p",null,(0,n.yg)("inlineCode",{parentName:"p"},"OrderAction.BuyToCover")," - will close a short position, should be used for closing the position or scaling out"),(0,n.yg)("p",null,"For live market ",(0,n.yg)("inlineCode",{parentName:"p"},"OrderAction.Buy")," and ",(0,n.yg)("inlineCode",{parentName:"p"},"OrderAction.BuyToCover")," will always buy and ",(0,n.yg)("inlineCode",{parentName:"p"},"OrderAction.SellShort")," and ",(0,n.yg)("inlineCode",{parentName:"p"},"OrderAction.BuyToCover")," will always sell."),(0,n.yg)("h3",{id:"market-orders"},"Market Orders"),(0,n.yg)("p",null,"Submitted market orders will get filled immidiatly. During historical execution TWM will use the next bar open value to fill the order."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-js"},'private void PlaceMarketEntryOrder(bool isLong)\n{\n    \n    if (isLong)\n    {\n        _entryOrder = SubmitOrder(0, OrderAction.Buy, OrderType.Market, PosSize, 0, 0,0, "", EnterLongName);\n\n    }\n    if (!isLong)\n    {\n        _entryOrder = SubmitOrder(0, OrderAction.SellShort, OrderType.Market, PosSize, 0, 0,0, "", EnterShortName);\n\n    }\n\n}\n')),(0,n.yg)("h3",{id:"limit-orders"},"Limit Orders"),(0,n.yg)("p",null,"For limit orders the following Ois true during historical execution."),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},"If there is NO position and order action is ",(0,n.yg)("inlineCode",{parentName:"p"},"Buy")," and low of the upcoming bar is equal or below the set price OR order action is ",(0,n.yg)("inlineCode",{parentName:"p"},"SellShort")," and high of the upcoming bar is equal or higher to the set limit price you will get a fill with the set limit price, your order state will be marked as filled, a new position will be created and a ",(0,n.yg)("inlineCode",{parentName:"p"},"OnOrderUpdate")," event will occur. In case if there was a gap you will get a fill using the rule ",(0,n.yg)("inlineCode",{parentName:"p"},"at price or better")," which will use the bar open.")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},"In case stop and profit orders have been set during the ",(0,n.yg)("inlineCode",{parentName:"p"},"OnOrderUpdate")," the StrategyBase class will perform a check for stop and limit orders fills within the same bar."))),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-js"},'private void PlaceLimitEntryOrder(bool isLong, double price)\n{\n    \n    if (isLong)\n    {\n        _entryOrder = SubmitOrder(0, OrderAction.Buy, OrderType.Limit, PosSize,price, 0,0, "", EnterLongName);\n\n    }\n    if (!isLong)\n    {\n        _entryOrder = SubmitOrder(0, OrderAction.SellShort, OrderType.Limit, PosSize, price, 0,0, "", EnterShortName);\n\n    }\n\n}\n')),(0,n.yg)("img",{src:o,alt:"Data Series Window",style:{width:700}}),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre"}," PlaceLimitEntryOrder(false,  Low[0] - TickSize*50);\n")),(0,n.yg)("p",null,"The above example clearly demonstrates where the historical order short fill has been filled with bar open price although its limit order price has been set 50 ticks below the signal bar low."),(0,n.yg)("h3",{id:"stop-market-orders"},"Stop-Market Orders"),(0,n.yg)("p",null,"To understand stop market orders we need to understand the concept of trigger price. Basicaly a stop market order will execute a market order when the market gets to a trigger price. It does not matter where the market is at the moment you place this order. "),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"If the market is ",(0,n.yg)("strong",{parentName:"li"},"above")," trigger price, market order will execute when the market goes ",(0,n.yg)("strong",{parentName:"li"},"below")," trigger price."),(0,n.yg)("li",{parentName:"ul"},"If the market is ",(0,n.yg)("strong",{parentName:"li"},"below")," trigger price, market order will execute when the market goes ",(0,n.yg)("strong",{parentName:"li"},"above")," trigger price."),(0,n.yg)("li",{parentName:"ul"},"If the market is ",(0,n.yg)("strong",{parentName:"li"},"equals")," trigger price, market order will executed ",(0,n.yg)("strong",{parentName:"li"},"immediately"),".")),(0,n.yg)("p",null,"It does not matter which order action we are planning on taking. The chosen action will execute once the conditions are met."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-js"},'private EnterMarket()\n{\n    if (_enterLong)\n        PlaceStopMarketEntryOrder(true, High[0] + TickSize*3);\n\n    if (_enterShort)\n        PlaceStopMarketEntryOrder(false,  Low[0] - TickSize*3);\n}\n\nprivate void PlaceStopMarketEntryOrder(bool isLong, double price)\n{\n    \n    if (isLong)\n    {\n        _entryOrder = SubmitOrder(0, OrderAction.Buy, OrderType.StopMarket, PosSize,\n            0, 0, price, "", EnterLongName);\n\n    }\n    if (!isLong)\n    {\n        _entryOrder = SubmitOrder(0, OrderAction.SellShort, OrderType.StopMarket, PosSize,\n            0, 0, price, "", EnterShortName);\n\n    }\n\n}\n')),(0,n.yg)("p",null,"In the example we see stop market sell executing a few ticks below the signal bar low. If there would have been a gap here the open price of the gap bar would have been used. However this is only because the market was above the trigger price when the order was placed."),(0,n.yg)("img",{src:a,alt:"Data Series Window",style:{width:700}}),(0,n.yg)("p",null,"The below example however, illustrates a completely different approach where we have deliberately set a stop market sell order way higher than then current market. In this case, when the market did reach the trigger price, a market order was executed and filled at trigger price historically. In real market please expect appropriate slippage in such cases. Trigger price does not guarantee price, it guarantees execution of a merket order if the trigger price is reached."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-js"},"if (_enterShort)\n    PlaceStopMarketEntryOrder(false,  High[0] + TickSize*300);\n")),(0,n.yg)("img",{src:l,alt:"Data Series Window",style:{width:600}}),(0,n.yg)("p",null,"On a historical market stop market orders behave differently when a position is already open. In this case they will act like a stop loss. If the position is open and a stop market order is placed main posints to consider are:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"These points are TRUE only for the historical execution"),(0,n.yg)("li",{parentName:"ul"},"You cannot scale in using this type of order"),(0,n.yg)("li",{parentName:"ul"},"The order can be used for exiting the position only")),(0,n.yg)("h3",{id:"stop-limit-orders"},"Stop-Limit Orders"),(0,n.yg)("p",null,"Stop limit order will place a limit order at limit price once the market has reached the trigger price. The limit order itself will work exactly as a standard limit order. Historical execution of stop limit orders is not currently supported. You can use stop limit orders only for live execution and placement on the exchange."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-js"},'private void PlaceStopLimitOrder(bool isLong, double price, double triggerPrice)\n{\n    \n    if (isLong)\n    {\n        _entryOrder = SubmitOrder(0, OrderAction.Buy, OrderType.StopLimit, PosSize,\n            price, 0, triggerPrice, "", EnterLongName);\n\n    }\n    if (!isLong)\n    {\n        _entryOrder = SubmitOrder(0, OrderAction.SellShort, OrderType.StopLimit, PosSize,\n            price, 0, triggerPrice, "", EnterShortName);\n\n    }\n\n}\n')),(0,n.yg)("h3",{id:"positions"},"Positions"),(0,n.yg)("p",null,"You can check existing strategy positions using the ",(0,n.yg)("inlineCode",{parentName:"p"},"LastPosition")," command or by looking through the ",(0,n.yg)("inlineCode",{parentName:"p"},"Positions")," collection. Last position will return the last position in the Positions collection. If a position exists and a new trade is made, it will add onto the existing position. Each ",(0,n.yg)("inlineCode",{parentName:"p"},"Position")," consists of ",(0,n.yg)("inlineCode",{parentName:"p"},"Trades")," that are stored inside it. In order to consider a position closed, all trades contained within a Position object have to be closed. If you close more trades than a Positoin object stores crating an overfill, the scipt will open a new Position to the other side."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-js"},"if (LastPosition.MarketPosition == MarketPosition.Flat)\n    return;\n\nif (LastPosition.MarketPosition == MarketPosition.Long)\n    return;\n\nif (LastPosition.MarketPosition == MarketPosition.Short)\n    return;\n\n")))}m.isMDXComponent=!0}}]);
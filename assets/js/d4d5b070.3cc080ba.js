"use strict";(self.webpackChunktwmdocs=self.webpackChunktwmdocs||[]).push([[5197],{9897:(e,t,n)=>{n.d(t,{xA:()=>d,yg:()=>m});var a=n(4805);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=c(n),g=r,m=u["".concat(l,".").concat(g)]||u[g]||p[g]||o;return n?a.createElement(m,i(i({ref:t},d),{},{components:n})):a.createElement(m,i({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=g;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},436:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var a=n(423),r=(n(4805),n(9897));const o=n.p+"assets/images/comissions-d584cd02c80afb48af448496a6f7ced3.png",i={sidebar_position:1},s="Core",l={unversionedId:"code/core",id:"code/core",isDocsHomePage:!1,title:"Core",description:"Custom Project",source:"@site/docs/code/core.md",sourceDirName:"code",slug:"/code/core",permalink:"/twmdocs/docs/code/core",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Accounts",permalink:"/twmdocs/docs/platform/accounts"},next:{title:"Indicators",permalink:"/twmdocs/docs/code/indicators"}},c=[{value:"Custom Project",id:"custom-project",children:[]},{value:"Debuging",id:"debuging",children:[]},{value:"Parameters",id:"parameters",children:[]},{value:"Execution",id:"execution",children:[]},{value:"Adding Data Series",id:"adding-data-series",children:[]},{value:"Comissions",id:"comissions",children:[]},{value:"Optimization Fitness",id:"optimization-fitness",children:[]}],d={toc:c},u="wrapper";function p(e){let{components:t,...n}=e;return(0,r.yg)(u,(0,a.A)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"core"},"Core"),(0,r.yg)("h3",{id:"custom-project"},"Custom Project"),(0,r.yg)("p",null,"TWM allows users to write their own extendable modules using C# language. In this section you will find tutorials and help on main API. TWN is installed together with a ",(0,r.yg)("inlineCode",{parentName:"p"},"Custom")," project file where user is capabale of writing code. You can use any IDE of your choice. In our documentation we will be demonstrating everyhting with the help of Visual Studio Community Edition wich is a free IDE that can be downloaded from ",(0,r.yg)("a",{parentName:"p",href:"https://visualstudio.microsoft.com/downloads/"},"here"),"."),(0,r.yg)("p",null,"Your intial installation will place the TWMCustom project here ",(0,r.yg)("inlineCode",{parentName:"p"},"C:\\Users\\User\\Documents\\Twm\\bin\\Custom"),". In order to start working with the custom project locate this folder and open the project or solution file ",(0,r.yg)("inlineCode",{parentName:"p"},"Twm.Custom.csproj")," or ",(0,r.yg)("inlineCode",{parentName:"p"},"Twm.Custom.sln")),(0,r.yg)("p",null,"You can compile the custom project from within the IDE or by running any compilation commands from within TWM. You can learn more about compiling and debuging ",(0,r.yg)("a",{parentName:"p",href:"/twmdocs/docs/platform/compilation"},"here"),"."),(0,r.yg)("h3",{id:"debuging"},"Debuging"),(0,r.yg)("p",null,"In order to Debug your project using an external IDE please read this ",(0,r.yg)("a",{parentName:"p",href:"/twmdocs/docs/platform/compilation#debuging"},"section")," You may alternatively debug using the Debug window of TWM found in Admin panel ",(0,r.yg)("inlineCode",{parentName:"p"},"New -> Debug"),". Use the below command to print to Debug window."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},'Print("Debug your code using this command");\n')),(0,r.yg)("h3",{id:"parameters"},"Parameters"),(0,r.yg)("p",null,"All parameters should be prefixed with a ",(0,r.yg)("inlineCode",{parentName:"p"},"[TwmProperty]")," tag. In case if this is an Indicator parameter it will allow it to be passed to TWM code auto generator upon compilation and become accessable inside the strategy code. In the case with the Strategy it will allow this parameter to become available inside the ",(0,r.yg)("inlineCode",{parentName:"p"},"Optimizer"),". "),(0,r.yg)("p",null,"The parameter defaults should be assigned inside the OnStateChanged event"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'[TwmProperty]\n[Display(Name = "Period", GroupName = Parameters, Order = 2)]\npublic int Period { get; set; }\n')),(0,r.yg)("p",null,"In order to be able to control category order ",(0,r.yg)("inlineCode",{parentName:"p"},'[Category("Category Name")]')," tag has to be used. Native categories such as Setup and DataSeries can also be ordered. The category order has to be set above the class name."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"[CategoryOrder(Setup, 0)]\n[CategoryOrder(DataSeries, 1)]\n[CategoryOrder(GlobalSettings, 2)]\n[CategoryOrder(EntrySettings, 6)]\n[CategoryOrder(Filters, 7)]\n[CategoryOrder(ExitSettings, 8)]\npublic class DefaultMACrossOver:Strategy\n{\n    \n}\n")),(0,r.yg)("h3",{id:"execution"},"Execution"),(0,r.yg)("p",null,"Whenever a strategy or indicator changes state the ",(0,r.yg)("inlineCode",{parentName:"p"},"OnStateChanged")," event takes place. We are able to get the current new state of the object and work with it. Some global parameters such as Name and Version should be set here."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"SetDefaults")," - mainly called whenever a user is working with the overall UI such as indicators or strategies dialog box where we see all indicators and strategies. This state should be used to set the defaults that we see when we enable such."),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Configured")," - this is a one time call when user enables the strategy/indicator. Called when user clicks enable or apply.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'public override void OnStateChanged()\n{\n    if (State == State.SetDefaults)\n    {\n        Name = "Indicator Name";\n        Version = "1.0";\n\n    }\n    else if (State == State.Configured)\n    {\n        \n    }\n}\n')),(0,r.yg)("p",null,"All historical and live execution of TWM strategies and indicators occurs ",(0,r.yg)("inlineCode",{parentName:"p"},"OnBarClose"),". Please use the demonstrated method below to create your code logic inside these overrides."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"public override void OnBarUpdate()\n{\n    //write your business logic here\n}\n\n")),(0,r.yg)("p",null,"During ",(0,r.yg)("strong",{parentName:"p"},"live")," execution of TWM strategies and indicators you can also use ",(0,r.yg)("inlineCode",{parentName:"p"},"OnTickUpdate")," to execute your business on a tick by tick basis. You can address the live candle values appropriatly."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'public override void OnTickUpdate(ICandle candle, ICandle tick)\n{\n    var close = candle.C;\n    var high = candle.H;\n    var low = candle.L;\n    var open = candle.O;\n    var time = candle.t;\n\n    Print("LIVE CANDLE. Close: " + close + " High:  "  +high + \n    " Low: " + low + " Open: " + open + " Time: " + time);\n\n}\n')),(0,r.yg)("p",null,(0,r.yg)("inlineCode",{parentName:"p"},"OnOrderUpdate")," event will occur every time there is any change inside the strategy order. Use this to control your orders during historical strategy execution."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'public override void OnOrderUpdate(Order order)\n{\n    Print("On order update: " + order.Name + \n         " Qnt: " + order.Quantity + \n         " Price: " + order.FillPrice+ \n         " Guid: "+ order.Guid + \n         " State: "+ order.OrderState);\n\n    if (State == State.Historical)\n        ManageOrders(order);\n}\n')),(0,r.yg)("p",null,(0,r.yg)("inlineCode",{parentName:"p"},"OnExecutionUpdate")," will occur only when something occurs to the order during ",(0,r.yg)("inlineCode",{parentName:"p"},"live")," exectuion ie. on the connection provider side. The OnExecutionUpdate event executes when we get a callback from the exchange only, it will not execute during historical strategy execution. Please make sure you use OnOrderUpdate during historical execution."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"public override void OnExecutionUpdate(Order order)\n{\n    if (State == State.RealTime)\n        ManageOrders(order);\n}\n")),(0,r.yg)("h3",{id:"adding-data-series"},"Adding Data Series"),(0,r.yg)("p",null,"It is possible to add an additional data series to indicator or strategy and work with that series. SymbolName string is optional, if nothing is passed the data series will be enabled on the same instrument."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'AddDataSeries(DataSeriesType.Hour, 1, "SymbolName");\n\n')),(0,r.yg)("h3",{id:"comissions"},"Comissions"),(0,r.yg)("p",null,"Comissions is an extendable TWM module. There are several pre-configured set ups available. The comissions are calculated at the end of each trade and we have a chance to interact with the trade data in order to make extra calculations. The returned comissions value will be deducted from the total pnl of the trade. Below is an example of most popular % based comission calculation. "),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"public override double GetCommission(Trade trade)\n{\n    var entry = (trade.ExitQuantity * trade.EntryPrice)*Commission/100;\n    var exit = (trade.ExitQuantity * trade.ExitPrice)*Commission/100;\n\n\n    return entry + exit;\n}\n")),(0,r.yg)("p",null,"TWM is already preset with spot and futures comissions presets for taker and maker options."),(0,r.yg)("img",{src:o,alt:"comissions",style:{width:700}}),(0,r.yg)("h3",{id:"optimization-fitness"},"Optimization Fitness"),(0,r.yg)("p",null,"You can access and code your own optimization fitness coefficient. Please look for examples in the optimization fitness folder. The optimzer will always try and find the max ",(0,r.yg)("inlineCode",{parentName:"p"},"Value")," parameter that you pass from here. "),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},'public class MaxProfitFactor : OptimizationFitness\n{\n    private const string OptimizationFitnessName = "Max Profit Factor";\n\n    public override void OnCalculatePerformanceValue(StrategyBase strategy)\n    {\n        Value = strategy.SystemPerformance.Summary.GetValue(AnalyticalFeature.ProfitFactor);\n\n    }\n\n    \n}\n')))}p.isMDXComponent=!0}}]);